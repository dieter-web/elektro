<%- include('aufgabe.ejs',{}) %>
<%- include('../../../../../layouts/partials/ergebnis.ejs') %>

<script type="module">
    import {tabulate} from "/modules/tabulate.mjs";
    import {drawboard} from "/modules/drawboard.mjs";
    import {populate} from "/modules/populate.mjs";
    import {vRClass} from "/d3/lib/Betriebsmittel/vRClass.mjs";

    // daten vom Server holen
    const data=await populate(
        "http://localhost:8000/json/example/beispiel11.json"
    );

    // tabelle ausgeben
    data.map( ( R ) =>
    {
        tabulate( R,"#ergebnis" );
    } );

    // RÃ¼ckkopplung
    const sel=d3.selectAll( "tbody" )._groups[ 0 ];

    // TODO: Doppelte Bezeichnung von R1 vermeiden !
    R1.value=sel[ 0 ].innerText.split( "\t" )[ 1 ];
    R2.value=sel[ 1 ].innerText.split( "\t" )[ 1 ];
    R3.value=sel[ 2 ].innerText.split( "\t" )[ 1 ];
    R4.value=sel[ 3 ].innerText.split( "\t" )[ 1 ];

    U.value=sel[ 0 ].innerText.split( "\t" )[ 2 ];

    // svg grafik
    const g=drawboard();

    let vR1=new vRClass( data[ 0 ] )
    let vR2=new vRClass( data[ 1 ] )
    let vR3=new vRClass( data[ 2 ] )
    let vR4=new vRClass( data[ 3 ] )


    g.append( () => vR1.createNode() )
    g.append( () => vR2.createNode() )
    g.append( () => vR3.createNode() )
    g.append( () => vR4.createNode() )

    // g.append( () => vRC( data[ 0 ] ) ); // R1
    // g.append( () => vRC( data[ 1 ] ) ); // R2
    // g.append( () => vRC( data[ 2 ] ) ); // R3
    // g.append( () => vRC( data[ 3 ] ) ); // R4
</script>
